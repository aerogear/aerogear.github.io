---
layout: basic
title: HSTS support on AeroGear
---

HSTS support
------------

*HSTS* (HTTP Strict Transport Security) is a security policy mechanism which enforces users to interact with SSL connections only, preventing attacks like man-in-the-middle.

This implementation is based on http://tools.ietf.org/html/rfc6797[RFC 6797] and depends on web browser implementation. Currently this implementation is supported only in Firefox and Chrome, for further details, please check http://caniuse.com/#search=hsts[caniuse.com] or the RFC. 

Common questions?
~~~~~~~~~~~~~~~~~

* How it will work on non supported browsers?

	- User will be redirected to HTTPS *location* attribute, but the browser won't be remembered to force HTTPS. 
	
* Is it required on AeroGear Controller and Security?

	- No, it's an optional feature
	
* With HSTS my system is bullet proof? 

	- Only if you cut the cables and your server is hosted on an island. Security is hard.


Getting started
~~~~~~~~~~~~~~~

1. Configuration
~~~~~~~~~~~~~~~~

Parameters on web.xml
^^^^^^^^^^^^^^^^^^^^^
Basically, browsers that support this feature, are able to remember the fact that a particular website requires HTTPS only, upon the next visit to the site in question the agent will enforce HTTPS.

* *max-age*: set how long the agent (browser) will be remembered to force HTTPS. 
* *include-subdomain*: this rule will be applied to all the subdomains or not. (*accepted values*: true/false).
* *location:* when user try to access *http://aerogear.org* for example, the default behaviour is to response with *HTTP 301* (indicating a permanent redirect)  pointing the browser to a new location.


JBoss configuration file:
^^^^^^^^^^^^^^^^^^^^^^^^^

To get started, please install and configure SSL support on JBoss http://docs.jboss.org/jbossweb/3.0.x/ssl-howto.html[http://docs.jboss.org/jbossweb/3.0.x/ssl-howto.html].

You can do it with:

	$JAVA_HOME/bin/keytool -genkey -alias tomcat -keyalg RSA

During the process make sure to setup the default password (*"changeit"*) already on JBoss, for testing purposes.

Copy this file https://gist.github.com/abstractj/a91c4fc960975a111803[standalone.xml] to *$JBOSS_HOME/standalone/configuration/*.

2. Deploy AG Controller demo
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

		git@github.com:aerogear/aerogear-controller-demo.git
		cd aerogear-controller-demo 
		mvn clean package
		cp target/aerogear-controller-demo.war $JBOSS_HOME/standalone/deployments

3. Testing
~~~~~~~~~~

* Visit http://localhost:8080/aerogear-controller-demo[http://localhost:8080/aerogear-controller-demo] and the servlet filter will redirect you to *location* specified into the https://github.com/aerogear/aerogear-controller-demo/blob/master/src/main/webapp/WEB-INF/web.xml[web.xml]

* Inspect HTTP headers on Chrome or Firefox.
