<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ClientSyncEngine Class Reference</title>
    <link rel="stylesheet" type="text/css" href="../css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="../css/highlight.css" />
    <meta charset='utf-8'>
    <script src="../js/jquery.min.js" defer></script>
    <script src="../js/jazzy.js" defer></script>
  </head>
  <body>
    <a name="//apple_ref/swift/Class/ClientSyncEngine" class="dashAnchor"></a>
    <a title="ClientSyncEngine Class Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="../index.html"> Docs</a> (100% documented)</p>
        <p class="header-right"><a href=""><img src="../img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="../index.html"> Reference</a>
        <img id="carat" src="../img/carat.png" />
        ClientSyncEngine Class Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
          <a href="../Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Classes/BackupShadowDocument.html">BackupShadowDocument</a>
              </li>
              <li class="nav-group-task">
                <a href="../Classes/ClientDocument.html">ClientDocument</a>
              </li>
              <li class="nav-group-task">
                <a href="../Classes/ClientSyncEngine.html">ClientSyncEngine</a>
              </li>
              <li class="nav-group-task">
                <a href="../Classes/Document.html">Document</a>
              </li>
              <li class="nav-group-task">
                <a href="../Classes/InMemoryDataStore.html">InMemoryDataStore</a>
              </li>
              <li class="nav-group-task">
                <a href="../Classes/ShadowDocument.html">ShadowDocument</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="../Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="../Protocols/ClientSynchronizer.html">ClientSynchronizer</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/DataStore.html">DataStore</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols.html#/s:P12AeroGearSync10Difference">Difference</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/Edit.html">Edit</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/PatchMessage.html">PatchMessage</a>
              </li>
              <li class="nav-group-task">
                <a href="../Protocols/Payload.html">Payload</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            <h1>ClientSyncEngine</h1>
            <p>The ClientSyncEngine is responsible for driving client side of the <a href="http://research.google.com/pubs/pub35605.html">differential synchronization algorithm</a>.
During construction the engine gets injected with an instance of ClientSynchronizer
which takes care of diff/patching operations, and an instance of ClientDataStore for
storing data.
<br/><br/>
A synchronizer in AeroGear is a module that serves two purposes which are closely related. One, is to provide
storage for the data type, and the second is to provide the patching algorithm to be used on that data type.
The name synchronizer is because they take care of the synchronization part of the Differential Synchronization
algorithm. For example, one synchronizer, such as <a href="https://github.com/aerogear/aerogear-ios-sync/blob/master/AeroGearSync-DiffMatchPatch/DiffMatchPatchSynchronizer.swift">DiffMatchPatchSynchronizer</a>, might support plain text while another, such as <a href="https://github.com/aerogear/aerogear-ios-sync/blob/master/AeroGearSync-JSONPatch/JsonPatchSynchronizer.swift">JsonPatchSynchronizer</a> supports JSON Objects as the
content of documents being stored. But a patching algorithm used for plain text might not be appropriate for JSON
Objects.
<br/><br/>
To construct a client that uses the JSON Patch you would use the following code:
<br/><br/>
<code>
var engine: ClientSyncEngine&lt;JsonPatchSynchronizer, InMemoryDataStore&lt;JsonNode, JsonPatchEdit&gt;&gt;
engine = ClientSyncEngine(synchronizer: JsonPatchSynchronizer(), dataStore: InMemoryDataStore())
</code>
<br/><br/>
The ClientSynchronizer generic type is the type that this implementation can handle.
The DataStore generic type is the type that this implementation can handle. 
The ClientSynchronizer and DataStore should have compatible document type.</p>

          </section>
          <section class="section task-group-section">
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:FC12AeroGearSync16ClientSyncEnginecUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FMGS0_Q_Q0__FT12synchronizerQ_9dataStoreQ0__GS0_Q_Q0__"></a>
                    <a name="//apple_ref/swift/Method/init(synchronizer:dataStore:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:FC12AeroGearSync16ClientSyncEnginecUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FMGS0_Q_Q0__FT12synchronizerQ_9dataStoreQ0__GS0_Q_Q0__">init(synchronizer:dataStore:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Default init.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="Swift">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="nv">synchronizer</span><span class="p">:</span> <span class="kt">CS</span><span class="p">,</span> <span class="nv">dataStore</span><span class="p">:</span> <span class="kt">D</span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>synchronizer</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>that this ClientSyncEngine will use.</p>

                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>dataStore</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>that this ClientSyncEngine will use.</p>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:FC12AeroGearSync16ClientSyncEngine11addDocumentUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FTGCS_14ClientDocumentQQ_1T_8callbackFGS5_S6__T__T_"></a>
                    <a name="//apple_ref/swift/Method/addDocument(_:callback:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:FC12AeroGearSync16ClientSyncEngine11addDocumentUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FTGCS_14ClientDocumentQQ_1T_8callbackFGS5_S6__T__T_">addDocument(_:callback:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Adds a new document to this sync engine.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="Swift">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">addDocument</span><span class="p">(</span><span class="nv">clientDocument</span><span class="p">:</span> <span class="kt">ClientDocument</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nv">callback</span><span class="p">:</span> <span class="kt">ClientDocument</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="p">())</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>document</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>the document to add.</p>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:FC12AeroGearSync16ClientSyncEngine4diffUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FGCS_14ClientDocumentQQ_1T_GSqQQ_1P_"></a>
                    <a name="//apple_ref/swift/Method/diff(_:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:FC12AeroGearSync16ClientSyncEngine4diffUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FGCS_14ClientDocumentQQ_1T_GSqQQ_1P_">diff(_:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Returns an PatchMessage of the type compatible with ClientSynchronizer (ie: eith DiffMatchPatchMessage or 
JsonPatchMessage) which contains a diff against the engine&rsquo;s stored shadow document and the passed-in document.
<br/><br/>
There might be pending edits that represent edits that have not made it to the server
for some reasons (for example packet drop). If a pending edit exits, the contents (ie: the diffs)
of the pending edit will be included in the returned Edits from this method.
<br/><br/>
The returned PatchMessage instance is indended to be sent to the server engine
for processing.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="Swift">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">diff</span><span class="p">(</span><span class="nv">clientDocument</span><span class="p">:</span> <span class="kt">ClientDocument</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">P</span><span class="p">?</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>document</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>the updated document.    </p>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>PatchMessage containing the edits for the changes in the document.</p>

                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:FC12AeroGearSync16ClientSyncEngine5patchUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FQQ_1PT_"></a>
                    <a name="//apple_ref/swift/Method/patch(_:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:FC12AeroGearSync16ClientSyncEngine5patchUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FQQ_1PT_">patch(_:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Patches the client side shadow with updates (PatchMessage) from the server.
<br/><br/>
When updates happen on the server, the server will create an PatchMessage instance
by calling the server engines diff method. This PatchMessage instance will then be
sent to the client for processing which is done by this method.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="Swift">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">patch</span><span class="p">(</span><span class="nv">patchMessage</span><span class="p">:</span> <span class="kt">P</span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>patchMessage</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>the updates from the server.</p>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:FC12AeroGearSync16ClientSyncEngine20patchMessageFromJsonUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FSSGSqQQ_1P_"></a>
                    <a name="//apple_ref/swift/Method/patchMessageFromJson(_:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:FC12AeroGearSync16ClientSyncEngine20patchMessageFromJsonUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FSSGSqQQ_1P_">patchMessageFromJson(_:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Delegate to Synchronizer.patchMessageFronJson. Creates a PatchMessage by parsing the passed-in json.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="Swift">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">patchMessageFromJson</span><span class="p">(</span><span class="nv">json</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">P</span><span class="p">?</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>json</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>string representation.</p>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>PatchMessage created fron jsons string.</p>

                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:FC12AeroGearSync16ClientSyncEngine14documentToJsonUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FGCS_14ClientDocumentQQ_1T_SS"></a>
                    <a name="//apple_ref/swift/Method/documentToJson(_:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:FC12AeroGearSync16ClientSyncEngine14documentToJsonUS_18ClientSynchronizer_S_9DataStore_US_4Edit__S_12PatchMessage____FGS0_Q_Q0__FGCS_14ClientDocumentQQ_1T_SS">documentToJson(_:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Delegate to Synchronizer.addContent.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="Swift">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">documentToJson</span><span class="p">(</span><span class="nv">clientDocument</span><span class="p">:</span><span class="kt">ClientDocument</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>clientDocument</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>the content itself.</p>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div>
                        <h4>Return Value</h4>
                        <p>String with all ClientDocument information.</p>

                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </section>
        </section>
        <section id="footer">
          <p>&copy; 2015 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2015-06-11)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.2.1</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
