<!doctype html>
<html>
<head>
  <title>AeroGear - AeroGear UnifiedPush Message Format - Unstable</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">

  <!-- Main styles-->
  <link href="/css/styles.css" rel="stylesheet" media="screen">

  <!-- Syntax highlighting -->
  <link href="/css/syntax.css" rel="stylesheet"> 

  <!-- Icons -->
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="/css/openshift-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
  <!-- Favicons -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <script src="//code.jquery.com/jquery-1.9.1.min.js"></script>


  <!-- google analytics -->
  <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28733717-2']);
      _gaq.push(['_setDomainName', 'aerogear.org']);
      _gaq.push(['_trackPageview']);

      (function () {
          var ga = document.createElement('script');
          ga.type = 'text/javascript';
          ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(ga, s);
      })();
  </script>
  

</head>

<body>    

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/index.html">AeroGear</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        

        <li class="">
          <a href="/">Home</a>
        </li>

        <li class="">
          <a href="/getting-started/overview/">Getting Started</a>
        </li>


        <li class="dropdown ">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Mobile Services<span class="caret"></span></a>
            <ul class="dropdown-menu" role="menu">
              <li><a href="/services/mobile-ci-cd/">Mobile CI/CD</a></li>
              <li><a href="/services/push/">Push Notifications</a></li>
              <li><a href="/services/metrics/">Metrics</a></li>
              <li><a href="/services/runtime-connector/">Runtime Connector</a></li>
              <li><a href="/services/identity-management/">Identity Management</a></li>
              <li><a href="/services/device-security/">Device Security</a></li>
            </ul>
        </li>

        <li class="dropdown ">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Mobile SDKs<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/sdks/android/">Android</a></li>
            <li><a href="/sdks/cordova/">Cordova</li>
            <li><a href="/sdks/ios/">iOS</a></li>
            <li><a href="/sdks/xamarin/">Xamarin</a></li>
          </ul>
        </li>

        <li class="hidden-sm active">
          <a href="https://docs.aerogear.org">Docs</a>
        </li>
   
        
        <li class="">
          <a href="/community">Community</a>
        </li>
        

        <li class="">
          <a href="/news">News</a>
        </li>
        
      </ul>

    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<section class="main-banner">
  <div class="container">
    
  <h2>Documentation <small>Aerogear API documentation &amp; specifications.</small></h2>

  </div><!-- container -->
</section> <!-- main banner -->


<section class="docs">
  
  <div class="container">
         <ol class="breadcrumb" style="margin:0">
      <li>
        
          <a href="/docs/specs/">Docs</a>
        
      </li>
      <li class="active">AeroGear UnifiedPush Message Format - Unstable</li>
    </ol>
  </div><!-- container -->


  <div class="container">
    <div class="row">
      
      <div class="col-md-3 hidden-sm hidden-xs sidebar">
        <ul class="nav">
   <li class="toc_level-1 toc_section-1">
      <a href="#sender">
         <span class="toctext">Sender</span>
      </a>
      <ul>
         <li class="toc_level-2 toc_section-2">
            <a href="#message-format">
               <span class="toctext">Message Format</span>
            </a>
         </li>
         <li class="toc_level-2 toc_section-3">
            <a href="#message-object">
               <span class="toctext">Message Object</span>
            </a>
         </li>
         <li class="toc_level-2 toc_section-4">
            <a href="#simplepush-object">
               <span class="toctext">SimplePush Object</span>
            </a>
         </li>
         <li class="toc_level-2 toc_section-5">
            <a href="#query-component">
               <span class="toctext">Query component</span>
            </a>
         </li>
      </ul>
   </li>
</ul>
      </div><!-- col -->
      
      <div class="col-md-9 post">
      
        <h1>AeroGear UnifiedPush Message Format - Unstable</h1>
        <p>The UnifiedPush Server allows sending messages to the native and non-native Push APIs. <span class="label label-warning">Development version</span></p>

<h3 id="links">Links</h3>

<ul>
  <li><a href="../push-message-format-1-0/">UnifiedPush Message Format - 1.0.x</a></li>
  <li><a href="./windows-document-format/">Windows message format</a></li>
</ul>

<h2 id="sender">Sender</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -u "{PushApplicationID}:{MasterSecret}"
   -v -H "Accept: application/json" -H "Content-type: application/json" 
   -X POST
   -d '{
       "criteria": {
         "variants" : ["c3f0a94f-48de-4b77-a08e-68114460857e", "444939cd-ae63-4ce1-96a4-de74b77e3737" ....],
         "alias" : ["user@account.com", "someone@aerogear.org", ....],
         "categories" : ["someCategory", "otherCategory"],
         "deviceType" : ["iPad", "AndroidTablet"]
       },
       "message": {
         "alert":"HELLO!",
         "sound":"default",
         "badge":7,
         "content-available" : true,
         "action-category" : "some_category",
         "simple-push": "version=123",
         "user-data": {
            "someKey":"some value",
            "anotherCustomKey":"some other value"
         },
         "windows": {                                                
            "type": "tile",                                         
            "duration": "short",                                    
            "badge": "alert",                                       
            "tileType": "TileWideBlockAndText01",                   
            "images": ["Assets/test.jpg", "Assets/background.png"], 
            "textFields": ["foreground text"]                       
          },                                                           
       },
       "config": {
         "ttl" : 3600,
       }
     }'

https://SERVER:PORT/CONTEXT/rest/sender
</code></pre></div></div>

<h3 id="message-format">Message Format</h3>
<p>The message format is very simple: A generic JSON map is used to sent messages to Android, iOS and Windows devices.</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">ttl</code> Specifies in seconds the <code class="highlighter-rouge">time-to-live</code> for the submitted notification. This value is supported by APNs and GCM. If a device is offline for a longer time than specified by the <code class="highlighter-rouge">ttl</code> value, the supported Push Networks may not deliver the notification.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">content-available</code> is an iOS specific argument to mark the payload as ‘content-available’. The feature is needed when sending notifications to Newsstand applications and submitting silent iOS notifications (iOS7)</p>
  </li>
</ul>

<h3 id="message-object">Message Object</h3>

<p>The applications on the devices will receive the JSON map and are responsible for performing a lookup to read values 
of the given keys.</p>

<h4 id="ios-special-keys">iOS special keys</h4>

<p>If the JSON map contains one of the following reserved keywords, Apple specific hooks will be invoked on the device:</p>

<ul>
  <li><code class="highlighter-rouge">alert</code> (triggers a dialog, displaying the value - no iOS API needs to be invoked by the app developer)</li>
  <li><code class="highlighter-rouge">sound</code> (plays a given sound  - no iOS API needs to be invoked by the app developer)</li>
  <li><code class="highlighter-rouge">badge</code> (sets the value of the badge icon - no iOS API needs to be invoked by the app developer)</li>
  <li><code class="highlighter-rouge">content-available</code> (iOS7 feature for submitting silent iOS notifications)</li>
  <li><code class="highlighter-rouge">action-category</code> (iOS8 feature for interactive notifications)</li>
</ul>

<h4 id="android-special-keys">Android special keys</h4>

<p>None! The JSON map is submitted as it is, directly to the device. There are no Android specific keywords.</p>

<h4 id="cordova-android-special-keys">Cordova Android special keys</h4>

<p>To make the user experience the same on iOS and Android, for cordova users, we use the iOS alert ‘key’ on Android as well to generate a notification for you. And we’ve introduced a ‘title’ that can optionally be used for the title of this notification, if none is specified the application name will be used like on iOS.</p>

<h4 id="windows-special-keys">Windows special keys</h4>

<p>For Windows we also support sending toast, tile, badge and raw notifications. For MPNS and WNS to keep the message uniform the first text for the message template is the value from alert and for a numeric badge we use the main badge field. Of course you could add criteria to only select Windows devices. If you don’t specify the Windows section of the message a toast notification is send with the alert as the content. More information about the <a href="windows-document-format/">windows message format</a></p>

<h3 id="simplepush-object">SimplePush Object</h3>

<p>For SimplePush an extra <code class="highlighter-rouge">simple-push</code> object is provided. This key is only used for SimplePush variants. The version is submitted to all connected client, that are subscribed on their matching channels.</p>

<h3 id="query-component">Query component</h3>

<p>Currently the Server will support the following query criteria:</p>

<ul>
  <li><code class="highlighter-rouge">variants</code>: A list of one or more <em>mobile variant ID’s</em> to identify a particular PushApplication variant (e.g. HR Android, HR iPad).</li>
  <li><code class="highlighter-rouge">alias</code>: A list of one or more <em>identifiers</em> (such as <code class="highlighter-rouge">email</code> or <code class="highlighter-rouge">username</code>) to send messages to <em>ALL</em> devices of the user(s). The <code class="highlighter-rouge">alias</code> needs to be stored, when the device is registering itself with the server.</li>
  <li><code class="highlighter-rouge">categories</code>: Helps to <em>tag</em> the current client with multiple categories. Gives a semantic meaning to a registered <code class="highlighter-rouge">Installation</code>.</li>
  <li><code class="highlighter-rouge">deviceType</code>: A list of raw device types that should receive the message (e.g. Coupon only for iPad and AndroidTablets). The <code class="highlighter-rouge">deviceType</code> needs to be stored when the device is registering itself with the server.</li>
</ul>

<p><em><strong>NOTE:</strong></em> All these query criterias are optionnal. If no criterias are passed it will act as a  <em>broadcast</em> send, where <em>all</em> clients are notified.</p>

      
      </div><!-- col 8 -->
    </div><!-- row -->
  </div><!-- container -->
</section>



<footer>
  <div class="container">
    <div class="row">
      <div class="col-sm-3">
        <h5>Getting Started</h5>
        <ul class="list-unstyled">
          <li><a href="/getting-started/overview/">Overview</a></li>
          <li><a href="/getting-started/installation-and-configuration/">Installation &amp; Configuration</a></li>
          <li><a href="/getting-started/creating-mobile-apps/">Creating Mobile Apps</a></li>
          <li><a href="/getting-started/enabling-mobile-services/">Enabling Mobile Services</a></li>
        </ul>
      </div><!-- col -->

      <div class="col-sm-3">
        <h5>Mobile Services</h5>
        <ul class="list-unstyled">
         <li><a href="/services/mobile-ci-cd/">Mobile CI/CD</a></li>
         <li><a href="/services/push/">Push Notifications</a></li>
         <li><a href="/services/metrics/">Metrics</a></li>
         <li><a href="/services/runtime-connector/">Runtime Connector</a></li>
         <li><a href="/services/identity-management/">Identity Management</a></li>
         <li><a href="/services/device-security/">Device Security</a></li>
        </ul>
      </div><!-- col -->

      <div class="col-sm-3">
        <h5>Mobile SDKs</h5>
        <ul class="list-unstyled">
         <li><a href="/sdks/android/">Android</a></li>
         <li><a href="/sdks/cordova/">Cordova</li>
         <li><a href="/sdks/ios/">iOS</a></li>
         <li><a href="/sdks/xamarin/">Xamarin</a></li>
        </ul>
      </div><!-- col -->
      
      <div class="col-sm-3">
        <h5>COMMUNITY</h5>
        <ul class="list-unstyled">
          <li><a target="_blank" href="https://github.com/aerogear/">GitHub - Aerogear</a></li>
          <li><a target="_blank" href="https://github.com/aerogearcatalog/">GitHub - Aerogear Catalog</a></li>
          <li><a target="_blank" href="https://issues.jboss.org/browse/AEROGEAR">Jira Repo Issues</a></li>
          <li><a  href="/community/contribution-guide/">Contribution Guide</a></li>
          <li><a target="_blank" href="https://groups.google.com/forum/#!forum/aerogear">Google Group</a></li>
          <li><a href="irc://irc.freenode.net/aerogear">IRC</a></li>
        </ul>
      </div><!-- col -->

      <div class="col-sm-12 follow">
        <h5>FOLLOW US</h5>
        <ul class="list-inline">
          <li><a target="_blank" href="https://www.twitter.com/aerogears"><i class="fa fa-twitter-square"></i> Twitter</a></li>
          <li><a target="_blank" href="https://www.facebook.com/AeroGearProject"><i class="fa fa-facebook-square"></i> Facebook</a></li>
          <li><a target="_blank" href="https://plus.google.com/106588661437153585722/posts"><i class="fa fa-google-plus-square"></i> Google+</a></li>
          <li><a target="_blank" href="/feed.atom"><i class="fa fa-rss-square"></i> Feed</a></li>
        </ul>
        
        <p>AeroGear project is licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a></p>
      </div><!-- col -->
    
    </div><!-- row -->

  </div><!-- container -->

</footer><!-- footer -->

<section class="redhat">
  <div class="container">
    <p class="text-center">
      <a href="http://www.redhat.com/">
        <img src="/img/redhatlogo-wite.png" alt="redhatlogo-wite" width="130">
      </a>
    </p>       
  </div><!-- container -->
</section>


<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<!-- <script src="/bower_components/jquery/dist/jquery.min.js"></script> -->

<!-- Include all compiled plugins (below), or include individual files as needed  -->  
<script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

<!-- My script -->
<script src="/js/script.js"></script>

</body>
</html>